@startuml
skinparam componentStyle rectangle
skinparam packageStyle rectangle
hide empty members

package "Минималистичная блокчейн-система" {
  package "Сетевой уровень" as NetworkLayer {
    [P2P-сеть] as P2PNetwork
    [Gossip/RPC] as GossipRPC
    [PeerManager] as PeerManager
    [NetworkMonitor] as NetworkMonitor
  }

  package "Уровень консенсуса" as ConsensusLayer {
    [PoS Validator] as PoSValidator
    [BFT Engine] as BFTEngine
    [Consensus Switcher] as ConsensusSwitcher
    [Consensus Strategy] as ConsensusStrategy
    [Consensus Monitor] as ConsensusMonitor
  }

  package "Хранилище" as StorageLayer {
    [Блокчейн] as BlockchainDB
    [TxPool] as TxPool
    [BlockVerifier] as BlockVerifier
  }

  package "Криптография" as CryptoLayer {
    [ECDSA Подписи] as SignatureModule
    [KeyManager] as KeyManager
  }

  package "Безопасность" as SecurityLayer {
    [Double Spend Guard] as DoubleSpendGuard
    [Sybil Guard] as SybilGuard
    [51% Defense] as FiftyOnePercentGuard
    [Security Auditor] as AuditLogs
  }

  package "Говернанс" as GovernanceLayer {
    [Upgrade Manager] as UpgradeManager
    [Reputation System] as ReputationSystem
    [Proposal Manager] as ProposalManager
    [Voting Manager] as VotingManager
  }

  package "Интеграция" as IntegrationLayer {
    [REST API] as RESTAPI
    [JSON-RPC] as JSONRPC
  }
}

' Связи между слоями
P2PNetwork --> ConsensusSwitcher
GossipRPC --> PeerManager
PeerManager --> P2PNetwork

ConsensusSwitcher --> PoSValidator
ConsensusSwitcher --> BFTEngine
PoSValidator --> SignatureModule
BFTEngine --> SignatureModule
BFTEngine --> GossipRPC

TxPool --> BlockVerifier
BlockchainDB --> BlockVerifier

SignatureModule --> AuditLogs

DoubleSpendGuard --> TxPool
SybilGuard --> PeerManager
FiftyOnePercentGuard --> ConsensusSwitcher
AuditLogs --> UpgradeManager

UpgradeManager --> ConsensusSwitcher

RESTAPI --> TxPool
RESTAPI --> BlockchainDB
RESTAPI --> AuditLogs

@enduml